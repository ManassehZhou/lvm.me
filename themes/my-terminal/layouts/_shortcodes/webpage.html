{{/*
Webpage shortcode for embedding external web pages with terminal.css styling
Usage: {{< webpage url="https://example.com" title="Website Title" width="100%" height="500px" >}}
*/}}

{{ $url := .Get "url" }}
{{ $title := .Get "title" | default "External Website" }}
{{ $width := .Get "width" | default "100%" }}
{{ $height := .Get "height" | default "500px" }}
{{ $sandbox := .Get "sandbox" | default "allow-scripts allow-same-origin allow-popups allow-forms" }}

{{ if $url }}
<div class="terminal-card" style="margin: calc(var(--global-space) * 2) 0;">
  <header>
    <span class="terminal-prompt">{{ $title }}</span>
  </header>
  <div style="padding: 0; position: relative; overflow: hidden;">
    <iframe 
      src="{{ $url }}"
      width="{{ $width }}" 
      height="{{ $height }}"
      title="{{ $title }}"
      frameborder="0"
      sandbox="{{ $sandbox }}"
      loading="lazy"
      style="display: block; width: 100%; border: none; background-color: var(--background-color);">
    </iframe>
    
    <!-- Fallback content -->
    <noscript>
      <div style="padding: var(--global-space); text-align: center; background-color: var(--code-bg-color); border: 1px solid var(--secondary-color);">
        <p style="color: var(--font-color); margin-bottom: var(--global-space);">
          External content cannot be displayed.
        </p>
        <a href="{{ $url }}" 
           target="_blank" 
           rel="noopener noreferrer"
           class="btn btn-primary"
           style="display: inline-block;">
          <span class="terminal-prompt">Visit Website</span>
        </a>
      </div>
    </noscript>
    
    <!-- External link indicator -->
    <div style="padding: calc(var(--global-space) / 2); text-align: center; border-top: 1px solid var(--secondary-color); background-color: var(--code-bg-color);">
      <a href="{{ $url }}" 
         target="_blank" 
         rel="noopener noreferrer"
         style="color: var(--secondary-color); font-size: 0.9em; text-decoration: none;">
        > Open in new tab: {{ $url }}
      </a>
    </div>
  </div>
</div>
{{ else }}
<div class="terminal-alert terminal-alert-error" style="margin: calc(var(--global-space) * 2) 0;">
  <span class="terminal-prompt">Error: Website URL not specified</span>
</div>
{{ end }}